Ambiguity Analysis
------------------

Based on our review of the webinos software architecture, we have defined 7 architectural patterns that characterise the webinos attack surface. For brevity, these are defined within the appendix, but are summarised in the table below:

  ------------------------------ ---------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------ ----------------------
  _.Architectural pattern   _.Description                                                     _.Components                                                                                                  _.No. of assets
  Context Policy Management      Model illustrating how policy management mediates the                  Context API, Context Database, Context Manager, Policy Manager, webinos API                                        15
  NFC                            Model illustrating the components associated with NFC                  Application Client, NFC Manager, NFC Manager B                                                                     14
  PZH Authentication             Model illustrating the components associated PZH authentication.       Discovery Manager, OpenID Proxy, PZH Provider, PZH Session Handler, User Agent                                     15
  PZP Enrolment                  Components associated with enrolling and authenticating PZPs to PZHs   Certificate Manager, Discovery Manager, Keystore Manager, PZH Provider, PZH Session Handler, PZP Session Handler   16
  TV Service Discovery           Model illustrating discovery and use of TV services                    Application Client, Discovery Manager, Policy Manager, TV Manager                                                  24
  Widget Processing              Model illustrating the components associated with widget processing    Policy Manager, Widget Manager                                                                                     21
  Widget Rendering               Model illustrating the components associated with widget rendering     Discovery Manager, Widget Renderer                                                                                 8
  ------------------------------ ---------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------ ----------------------

Based on both the pattern specifications and the damage effort ratio formula defined the methodology, the quantitative attack surface of webinos is summarised in the below table:

  ------------------------------ ------------------- ------------------- -------------------
  _.Architectural pattern   _.DER_m   _.DER_c   _.DER_i
  Context Policy Management      1.2                 6.1                 28.6
  NFC                            1.4                 4                   39.5
  PZH Authentication             9.6                 6.1                 29.7
  PZP Enrolment                  11.2                5                   16.6
  TV Service Discovery           3.7                 4.2                 29
  Widget Processing              1.1                 1                   22.9
  Widget Rendering               2.8                 2                   28.6
  ------------------------------ ------------------- ------------------- -------------------

At a one-day workshop held in Berlin in August 2012, the leaf obstacles resulting from the attack resistance analysis were reviewed and, based on these, 71 mitigating requirements were elicited. Each requirement was analysed to determine its affected components and whether these were adequately addressed by the webinos software architecture. A summary of this analysis is documented in the table below:

  ----------------------------------------------------------- ----------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------- ------------------------ -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  _.Obstacle                                             _.Mitigating Requirement Name                          _.Mitigating Requirement Definition                                                                                     _.Affected Components                                             _.Satisfied (Y/N)   _.Rationale
  Account deleted                                             Authorised account removal                                  The OpenID account shall be removed only by an authorised user.                                                              N/A                                                                    N                        Deletion of OpenID account out of scope
  Account lock-out                                            OpenID lock-out recovery                                    Locked out OpenID credentials shall be recoverable.                                                                          OpenID Proxy                                                           N                        OpenID account recovery procedure is out of scope.
  Ambiguous request specification                             Canonical request specification                             The request specification shall be validated before use.                                                                     Policy Manager                                                         Y                        Each request is enforced separately by definition. Hence, it’s impossible to grant access to more resources than required.
  Ambiguous resource spec                                     Canonical request specification                             The request specification shall be validated before use.                                                                     Policy Manager                                                         Y                        Each request is enforced separately by definition. Hence, it’s impossible to grant access to more resources than required.
  App running in browser                                      App running in widget renderer                              webinos applications shall run only in approved widget renderers.                                                            Widget Renderer                                                        N                        There are no approved widget renderers.
  Application blacklisted after negative reviews              Application blacklist checks                                webinos supported app stores shall periodically check the validity of submitted reviews.                                     Widget Manager                                                         N                        webinos supported app stores are out of scope.
  Application data intercepted                                Widget data authorisation                                   Application data from widgets shall be accessible only to authorised components.                                             Widget Manager                                                         N                        Although applications shall only access data permitted by the underlying system, circumventing cross-origin resource sharing restrictions via native application access to application data is out of scope.
  Application data readable                                   Widget data authorisation                                   Application data from widgets shall be accessible only to authorised components.                                             Widget Manager                                                         N                        Although applications shall only access data permitted by the underlying system, circumventing cross-origin resource sharing restrictions via native application access to application data is out of scope.
  Application developer signing key compromised               Application developer signing key storage                   The application developer’s signing key shall be safeguarded from unauthorised access.                                       Keystore Manager                                                       N                        Keys are currently saved in $HOME/.webinos. If we use the keyring, platform applications can access contained keys once keyring is unlocked
  Application has user identifier without permission          User identifier permission                                  Application shall be authorised to access to user identifier.                                                                Policy Manager                                                         Y                        User identifier is a controllable resource.
  Application impossible to use                               Application QoS                                             A webinos application shall satisfy its specified quality of service expectations.                                           Application Client                                                     N                        We have no way of asserting how an application’s quality of service expectations might be expressed or satisfied.
  Application signing key not checked                         Application signing key verified                            Update procedure shall verify that the update signing key matches the original signing key.                                  Widget Manager                                                         Y                        widgetmanager.js performs the author matching (calling matching code in comparisonresult.js)
  Apps share usage data                                       Usage data sharing restriction                              The sharing of usage data shall be restricted between applications.                                                          Context Manager, Widget runtime                                        N                        Because there are several ways applications can share data, including server-side out of band methods, usage sharing restrictions are out of scope. However, privacy policies can explain what an application proposes to do with user supplied data, which may allow users to make informed choices at install time.
  Attacker obtains user password                              User password authorisation                                 Authorisation shall be necessary to obtain a user login password.                                                            PZH Provider                                                           N                        While we can recommend safe OpenID providers and make recommendations, controlling how OpenID providers are run is out of scope.
  Authentication failure                                      OpenID authorisation                                        OpenID authentication process shall authenticate users.                                                                      OpenID Proxy                                                           N                        webinos should use PAPE extension and set max_auth_age=0 in order to prevent authentication caching
  Automate personal zone enrolment                            Manual personal zone enrolment.                             Devices shall be enrolled into a personal zone only through the use of an out-of-bound challenge.                            PZH Provider, PZP Session Handler                                      N                        Manual personal zone enrolment is circumvented by the latest specification which allows in-band authentication.
  Bad default policy                                          Permissive default policy                                   The default webinos policy shall be permissive enough to require no modification for the majority of webinos applications.   Policy Manager                                                         Y                        The API default options are reasonable given the majority of expected applications.
  Bad trust decisions                                         Trust information.                                          Users shall be provided sufficient information to identify malware when making authorisation decisions.                      Widget Manager                                                         N                        Recommending what might be sufficient information to identify prospective malware is out of scope.
  Bad user-selected policy                                    Best-practice policy                                        The user shall select best-practice policy settings.                                                                                                                                                N                        The default policy is only a static template rather than anything specific to a device or personal zone.
  Badly configured policy                                     Best-practice policy                                        The user shall select best-practice policy settings.                                                                                                                                                N                        The default policy is only a static template rather than anything specific to a device or personal zone.
  Browser API authorised                                      Browser API unauthorised                                    The use of browser APIs shall be forbidden in webinos applications.                                                          Widget Renderer                                                        N                        Forbidding access to browser-provided APIs is not possible without specifying a webinos specific browser.
  Browser Geolocation API accessed                            Browser API unauthorised                                    The use of browser APIs shall be forbidden in webinos applications.                                                          Widget Renderer                                                        N                        Forbidding access to browser-provided APIs is not possible without specifying a webinos specific browser.
  Credentials changed                                         Credentials change authorisation.                           OpenID credentials shall be changed only by authorised users.                                                                N/A                                                                    N                        Changing OpenID credentials out of scope
  Eavesdrop Context Database                                  Policy management secrecy                                   Policy management requests shall be visible only to authorised users.                                                        Policy Manager                                                         Y                        Policy management calls are sent over TLS
  Eavesdrop Context Manager                                   Policy management secrecy                                   Policy management requests shall be visible only to authorised users.                                                        Policy Manager                                                         Y                        Policy management calls are sent over TLS
  Eavesdrop Policy Manager                                    Policy management secrecy                                   Policy management requests shall be visible only to authorised users.                                                        Policy Manager                                                         Y                        Policy management calls are sent over TLS
  Eavesdrop request enforcement channel                       Secret request enforcement channel                          Request enforcement channels shall be visible only to authorised users.                                                      PZP Session Handler, Policy Manager                                    Y                        Access requests come either over the overlay network (which is only served using TLS) or between the widget renderer and PZP using a secure websocket. However, there is the potential for man-in-the-browser attacks.
  Eavesdrop RPC Call Log                                      Secret RPC Call Log                                         RPC call logs shall be visible only to authorised users.                                                                     PZP Session Handler, Context Manager                                   N                        Misusing the secrecy of the context database can be misused for this purpose. However, context logging is turned off by default and must be requested with permissions.
  findService API reveals permanent user identifier           Pseudonymous API user identifier                            The output of the findServices API shall be a temporary pseudonymous identifier.                                             Discovery Manager                                                      N                        Pseudonymous identifiers are currently not supported.
  Forgotten credentials                                       Memorable credentials                                       webinos user credentials shall be memorable.                                                                                 PZH Provider                                                           N                        The creation of memorable credentials for managing PZHs is not mandated.
  Installed App allows unrestricted postMessage               Installed app postMessage non-repudiation                   Installed applications shall disallow postMessages from unrecognised origins                                                 PZP Session Handler                                                    Y                        Origins can be verified on Messaging.
  Installed App allows unrestricted XHR                       Installed app XHR non-repudiation                           Installed applications shall disallow XHRs from unrecognised origins.                                                        PZH Provider, PZP Session Handler                                      N                        While use of W3C WARP or Mozilla’s Content Security Policy can achieve this non-repudiation, this is not explicitly supported by webinos.
  Installed app exploited                                     Application use authenticy                                  An installed application shall be controlled only by authorised users and applications.                                      Widget Manager                                                         N                        Verifying the authenticity of prospective malware is out of scope.
  Installed App given API permissions                         Personal data unauthorised to trusted apps                  Installed apps shall be unable to access personal data.                                                                      N/A                                                                    N                        Controlling whether or not webinos applications may be trusted with personal data is out of scope.
  Installed app misbehaving                                   Installed application behaviour cannot be interfered with   The behaviour of installed applications shall not changed based on outside influence or attackers.                           PZH Provider, PZP Session Handler, Policy Manager, Discovery Manager   N                        Protecting the integrity of the application packages and isolation / freedom from influence by other entities is not currently supported.
  Installed App uses unauthenticated webinos event messages   Installed app message non-repudiation                       Installed applications shall verifiy the authenticity of event message origin.                                               PZP Session Handler                                                    Y                        We can rely on the Events API read-only "from" field that is written only by PZP.
  Installed App vulnerable to content injection               Installed app content injection tests                       Installed applications shall be resistant to content injection attacks                                                       Widget Renderer                                                        N                        Control over browser based widget renderers is out of scope.
  JavaScript injection overwrites webinos.js                  Immutable webinos modules                                   webinos code modules shall be non-modifiable by webinos applications.                                                        Application Client                                                     N                        There are no File API restrictions for accessing webinos code modules
  JavaScript injection overwrites webinos.js                  Verified webinos.js                                         The integrity of webinos.js is verified by the widget renderer                                                               Widget renderer                                                        N                        Verifying webinos.js is out of scope while webinos supports web browsers and web apps must include their own webinos.js file. Having a common include path for webinos.js may be an improvement, or replacing this approach in a browser model.
  JavaScript injection triggers security violation            Prevent javascript from other domains                       Prevent malicious entities from injecting javascript into web applications                                                   Widget renderer                                                        N                        Preventing hosted applications from being vulnerable from JavaScript injection is out of scope. Various approaches can protect against attacks on the client side, such as CSP restrictions, but these are not implemented.
  JavaScript injection triggers security violation            Verified injected javascript                                Injected javascript running within webinos components is verified.                                                           Widget renderer                                                        N                        Verification against code injection is not currently implemented for webinos.js and javascript from other domains.
  Malicious App installed                                     Verified application installation                           webinos applications shall be verified before installation.                                                                  Widget Manager                                                         Y                        widgetprocessor.js performs the signature validation (the called validation code is in widgetvalidator.js)
  Malicious background application installed                  Verified application installation                           webinos applications shall be verified before installation.                                                                  Widget Manager                                                         Y                        widgetprocessor.js performs the signature validation (the called validation code is in widgetvalidator.js)
  Malicious App misuses communication interface               Installed app communication verification                    Installed applications shall verify communication to webinos applications.                                                   PZP Session Handler                                                    Y                        Application could read the "from" field of the received event and attest it.
  Malicious background application running                    Verified background application                             The behaviour of background applications shall be verified.                                                                  PZP, Widget manager                                                    N                        While we can recommend the use of app stores with verified applications and suggest the setting of sensible default policies, satisfying this goal is out of scope.
  Malicious code evaluated                                    Malicious code unevaluated                                  Event handlers shall process only non-executable JSON content.                                                               Application Client, PZP Session Handler                                N                        There are no restrictions within event handlers for executing JSON.
  Malicious NDEF tag                                          Trusted NDEF message content                                Processed NDEF messages shall contain trusted code.                                                                          NDEF Manager                                                           N                        There are no restrictions planned on how NDEF messages shall be processed within webinos.
  Malicious plugin not detected                               Plugin verification                                         Plugins shall be verified before user installation.                                                                          Widget Renderer                                                        N                        Control over browser based widget renderers is out of scope.
  Malware installed                                           Verification before installation                            Software shall be verified before it is installed by end users.                                                              Widget Manager                                                         N                        While we can recommend the use of app stores with verified applications, satisfying this goal is out of scope.
  Missing Access Request validation                           Access request validation                                   Access requests shall contain a validating DTD or schema                                                                     Policy Manager                                                         Y                        Currently being implemented for the second phase.
  Missing Policy file validation                              Policy file validation                                      Policy files shall contain a validating DTD or schema                                                                        Policy Manager                                                         Y                        Currently being implemented for the second phase.
  Native malware running                                      Native malware not running                                  webinos software shall be isolated from native malware running on a device.                                                  N/A                                                                    N                        webinos makes no assurances about a potentially compromised platform.
  Non-mandated request                                        Mandated request                                            Access requests shall be non-repudiable.                                                                                     Policy Manager                                                         Y                        All access requests are served between PZPs over TLS
  OpenID provider offline                                     OpenID provider online                                      PZH administrative access shall be possible only if the OpenID provider is online.                                           OpenID Proxy                                                           Y                        If the OpenID provider is offline it is not possible to carry out the OpenID authentication
  Overrestricted resource                                     Restricted resource                                         Resource restrictions shall be commensurate with their specifications.                                                       Policy Manager                                                         Y                        Each request is enforced separately by definition. Hence, it’s impossible to grant access to more resources than required.
  Unrestricted resource                                       Restricted resource                                         Resource restrictions shall be commensurate with their specifications.                                                       Policy Manager                                                         Y                        Each request is enforced separately by definition. Hence, it’s impossible to grant access to more resources than required.
  Overwrite valid authentication data                         Authenticate authentication data changes                    Re-authentication shall be necessary to update authentication data.                                                          PZH Provider                                                           Y                        Need to authenticate to the hub to change synchronised policies
  Overwrite valid PZP Configuration                           Authenticate PZP changes                                    Re-authentication shall be necessary to update PZP configuration data                                                        PZP Session Handler                                                    Y                        Every time PZP has update configuration data, it will be treated as a new PZP to authenticate
  Password guessed and reset                                  Password brute force resistance                             OpenID credentials used for personal zone authentication shall be resistant to brute force attacks.                          OpenID Proxy                                                           N                        OpenID credentials’ details, which are a secret shared between OpenID providers and users, are out of scope.
  Password recovery process attacked                          Password recovery resistance                                The reset of personal zone credentials shall be isolated from the OpenID account recovery procedure.                         OpenID Proxy                                                           N                        OpenID account recovery procedure is out of scope.
  Permission prompt click-through                             Click-through controls                                      Permission prompts shall prevent dialog click-through.                                                                       PZH Provider                                                           Y                        Based on a proposed mock-up, click-throughs will not result in a default policy.
  Policy misconfigured                                        Policy validation                                           Policy settings shall be user validated before use.                                                                          Policy Manager                                                         N                        Supporting the user validation of policy files is out of scope.
  Post spoofed message                                        Message non-repudiation                                     Event messages shall be non-repudiable.                                                                                      PZP Session Handler                                                    Y                        Message ‘from’ fields are filled in by the PZP, which is able to authenticate the source of each message.
  Spoof message origin                                        Message non-repudiation                                     Event messages shall be non-repudiable.                                                                                      PZP Session Handler                                                    Y                        Message ‘from’ fields are filled in by the PZP, which is able to authenticate the source of each message.
  Spoof network settings message origin                       Message non-repudiation                                     Event messages shall be non-repudiable.                                                                                      PZP Session Handler                                                    Y                        Message ‘from’ fields are filled in by the PZP, which is able to authenticate the source of each message.
  Post spoofed message                                        PZP message authenticity                                    PZP shall authenticate the origin of messages it sends.                                                                      PZP Session Handler                                                    Y                        PZPs add the ‘from’ field to messages based on the sender who has been authenticated through the webinos PKI
  Spoof message origin                                        PZP message authenticity                                    PZP shall authenticate the origin of messages it sends.                                                                      PZP Session Handler                                                    Y                        PZPs add the ‘from’ field to messages based on the sender who has been authenticated through the webinos PKI
  Spoof network settings message origin                       PZP message authenticity                                    PZP shall authenticate the origin of messages it sends.                                                                      PZP Session Handler                                                    Y                        PZPs add the ‘from’ field to messages based on the sender who has been authenticated through the webinos PKI
  PZH Admin URL displayed without prominence                  PZH admin URL displayed prominently                         The PZH admin URL bar is visible on supported webinos device platforms.                                                      PZH Provider                                                           N                        While a customised browser could present additional GUIs which authenticate the PZH to the user in a more visible way, control over browser displays is out of scope.
  PZH Admin URL not well known                                PZH Admin URL well known                                    The PZH Admin URL shall be recognisable to users.                                                                            PZH Provider                                                           N                        While recommendations can be made for how admin URLs should be formatted, we cannot control the format of URLs, which users are bad at parsing.
  PZH Admin URL too complicated                               Human-readable PZH admin URL                                PZH admin URLs shall be human readable.                                                                                      PZH Provider                                                           N                        We cannot control the format of URLs but the specifications should recommend their format.
  Revoke device from valid personal zone                      Device revocation authentication                            Re-authentication shall be necessary to revoke devices from personal zone.                                                   PZH Provider                                                           Y                        Authentication carried out via the PZH admin interface.
  Run multiple personal zone proxies                          Single personal zone proxy                                  Running more than a single personal zone proxy on a device shall be disallowed.                                              PZP Session Handler                                                    N                        There are currently no explicit checks for instances of multiple PZP configuration data on a single device.
  SMS intercepted and relayed                                 Messaging authentication                                    Messaging API users shall be authenticated before API use.                                                                   Policy Manager                                                         Y                        This can be configured using the policy framework, but this is not the default.
  Test API enabled                                            Test API disabled                                           Test APIs shall be disabled in installation environments.                                                                    Widget Manager                                                         N                        There are no supported means for distinguishing test APIs from those which are officially supported. We do, however, intend to impose a naming scheme that will enable the disabling of test API’s in installation environment, either when packaging/building webinos or on install time.
  Test configuration enabled                                  Test configuration disabled                                 Test and sample configuration data shall be disabled in installation environments.                                           Widget Manager                                                         N                        There are no supported means for distinguishing test and sample configuration data from valid platform or application data. But we intend to impose a naming scheme that will enable the disabling of test and sample configuration in installation environment, either when packaging/building webinos or on install time.
  Unrestricted request specification                          Restricted request specifications                           User agent requests to network resources shall be restricted.                                                                Policy Manager                                                         Y                        Requests to access network resources are represented by the feature http://webinos.org/action/network-access
  Unspecified resource                                        Specified resource                                          Access requests shall specify the resources requiring authorisation.                                                         Policy Manager                                                         Y                        Policy manager permits or denies access to resources only after matching the requested feature list against policies. Therefore all required resources must be specified in the requests. However, resources that don’t have associated resources cannot be directly controlled by the policy manager
  User clicks on link within application                      Unspoofable PZH admin URLs                                  PZH admin page URLs shall be non-spoofable                                                                                   PZH Provider                                                           N                        Control over URLs visited by browsers is out of scope.
  Webinos backdoor                                            Webinos backdoor tests                                      webinos platform shall test for the presence of backdoor procedures.                                                         N/A                                                                    N                        Testing for the presence of backdoors is not currently within scope. Gatekeeping processes are currently being considered for change requests which will consider the potential for such backdoors being introduced.
  Webinos widget processor bug                                Widget processor verification                               Webinos widget processors shall be verified before release.                                                                  Widget Manager                                                         N                        Widget processors are not part of the webinos system specification.
  Widget renderer supports extensions                         Authorised widget renderer extensions                       Widget renderers shall support only authorised extensions                                                                    Widget Renderer                                                        N                        Security of the widget renderers is out of scope.
  XSS attack on hosted app                                    Hosted app XSS resistance                                   Hosted applications shall be resistant to known XSS attacks.                                                                 Widget Renderer                                                        N                        Security of hosted applications is out of scope.
  ----------------------------------------------------------- ----------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------- ------------------------ -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


