Tools
=====

Partners Involved in this Theme
-------------------------------

-   Volantis, W3C

Definition
----------

Quotes from Christian’s email:

> The idea was to provide or suggest common tools to help keeping the
> specification parts similar and well aligned.
> For example, BONDI used to define their APIs by writing Pseudo-Code
> with pre-defined comment-strings
> (…)
> And then the ‘formal’ API Specification was automatically generated
> from the comments. This had the advantage that the specification
> deliverable had a common look and feel and also that specifications
> were always related to some (at least pseudo-code).
> (…)
> What should be created or described her here is a set of tools that
> should be used to create the specifications, not the tools used
> within the webinos system.
> (Similar things with graphics - I assume that some specifications
> might use UML diagrams and it would be helpful if everyone uses
> the same tool to create them (and we don’t end up with ten different
> looking styles for presenting them).
> So it’s about common tools used in the specification process itself.

Activities
----------

1.  Define common standards for creating architecture documentation (Will the architecture be created on Wiki? Is it possible/necessary to generate a PDF/HTML/Word/PPT document? Should we always embed the links to UML diagrams, to allow others to modify them? Should the external files/deliverables follow some naming conventions? Are we going to organize the content using a well-defined methodology (Rozanski&Woods, Kruchten, etc.)?).
2.  Define which formats and standards will be used for different parts of architecture documentation (What format will be used for creating UML diagrams? Do we have any guidelines for creating UML diagrams? What standard will we use for describing the interfaces? Do we need to create own standard e.g. for documenting APIs?)
3.  Propose open source tools that may be used for creating specific parts of documentation (What tools can be used for creating UML? Are the tools available under Windows, Linux and Mac? Do we have any policy on using cloud services and tools, like Google Documents and Dropbox?)
4.  Propose new tools that could be created by the webinos team to make our work on architecture more efficient (Do we need a custom tool for converting interface documentation to other formats? Do we need a custom tool for converting UML formats?)

API Editing tools
-----------------

### Widlproc

WAC and BONDI API specifications have been mostly created using a toolchain that converts annotated WebIDL files into HTML documentation.

API Authors edit a WebIDL file in which additional information is included through comments following a similar syntax to Doxygen. These Doxygen-like comments provide information about the meaning of the interfaces, attributes, methods and input arguments. Futhermore, some security aspects (e.g. which methods are security sensitive) can be also documented through appropriate keywords. Detailed information about the supported syntax is available at: http://widl.webvm.net/svn/widlproc/trunk/doc/widlproc.html.

The annotated WebIDL (aka widl) could be converted through the widlproc tool into an XML file. The widlproc tool is an opensource tool developed by Aplix that is licensed through Apache 2. The source code is available at: http://widl.webvm.net/svn/widlproc/trunk/.

The XML file generated by widlproc can then be converted through an XSL into an HTML file with customised styling based on CSS. Two different styles created based in similar widl can be found at:

http://bondi.omtp.org/1.1/apis/devicestatus.html
http://specs.wacapps.net/wac2_0/feb2011/deviceapis/devicestatus.html

This approach is quite flexible and scriptable: e.g. it is very easy to create scripts that process many widls and based on that auto-generates the documentation. For instance, in WAC we have some hooks in SVN that update the documentation every time a widl is committed to the database. Additionally, Webinos could create their own spec Look&Feel by tweaking the XSL and CSS used for HTML generation and styling.

As an XML is generated in the intermediate step, it should be relative easy to create the documentation in alternative formats to HTML (e.g. ePub or PDF). Alternatively, that XML could be also used for generating the stubs of the code for the API implementation or for generating SDK plugins.

Some drawbacks of this toolchain:

1.  The doxygen comments only supported a limited set of HTML tags, which restricts a bit the richness of the documentation that can be included. E.g. the img tag is not currently supported.
2.  The WebIDL spec in which it is based on, it is outdated (2009!), although the amount of changes since that version are not that significant (at least from a syntactical point of view)
3.  Is not exactly a wysiwyg tool. There are many differences between what you see and what you get.

However, if Webinos believe this toolchain is the right way forward, we can overcome 1 and 2 as we have access to the source code. Furthermore, Webinos could also contribute back any improvements made in the wildproc tool to the community.

### Respec.js

ReSpec is a Javascript based tool created by Robin Berjon that allows editors to write a specification focusing on the actual features and correctness, while needing to pay as little attention as possible to issues pertaining to styling. This tool allows spec editors to edit directly an HTML file that should make use of the Respec.js script library. When the HTML is rendered by a browser, the appropriate styling is applied by Respec.js.

The documentation for this tool is available at:

http://dev.w3.org/2009/dap/ReSpec.js/documentation.html

Although this mechanism is useful when editing the spec, when it is ready for publication, the tool also allows to save a snapshot of the spec with no scripting at all, so it is a "static" HTML page.

This tool has been mostly used in the W3C DAP API Specs, for instance:

http://dev.w3.org/2009/dap/messaging/

The source code is publicly available and is licensed through W3C license: http://www.w3.org/Consortium/Legal/2002/copyright-software-20021231

A new version of ReSpec ("ReSpec2":http://dvcs.w3.org/hg/respec2/) is also in development and is supposed to offer a more modular approach, making it more customizable.

Checkers
--------

During BONDI development, it was acknowledged that apart from enforcing WebIDL syntax, further checkings should be done in the specification, for instance:

1.  Ensuring that all the input arguments are document in the widl prose.
2.  Check that all the data types used are either primitive data types or defined in the module or included modules.
3.  Ensure that all the security sensitive methods are asynchronous
4.  …

In order to do it, Marcin Hanclik (ACCESS) created a tool based on PHP that extracted the code from the same widls used in conjunction to widlproc to populate a database. The information of database was processed for two different purposes:

-   Create some checkers that highlighted problems in the spec.
-   Generate (yet) another version of the API documentation.

Unfortunately the tool was not open source and Marcin is not involved in WAC anymore, but you can still have a look at the results created by the tool, for instance at:

http://bondi01.obe.access-company.com/1_1_5775_146/

The "W3C WebIDL checker":http://www.w3.org/2009/07/webidl-check takes a similar approach, and allows to extract WebIDL fragments from HTML pages, and run in addition to syntactic checks a set of more advanced checks as defined by the prose of the WebIDL specification.

The WebIDL checker builds upon widlproc through an "open-source Python script":http://dev.w3.org/cvsweb/2009/webidl-checker/ .

Proposal
--------

All the initiatives that are defining EcmaScript APIs are using WebIDL, Webinos should follow the same approach and use WebIDL to specify the interfaces.

With regards to the authoring tool for creating the specification, a wildproc toolchain looks like the most flexible approach as it can be used for the specification and implementation tasks. The widlproc tool should be modified in order to support new features (e.g. HTML img tags) and customize it according to Webinos targets. Webinos should also contribute back the improvements done in widlproc so other initiatives could also benefit from those improvements.

