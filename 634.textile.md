DEPRECATED, Please refer to "Background":http://dev.webinos.org/redmine/projects/wp3-1/wiki/Background_-_Security and "Specification":http://dev.webinos.org/redmine/projects/wp3-1/wiki/Spec_-_Security
==================================================================================================================================================================================================================================

![](http://dev.webinos.org/resources/webinos.jpg)

{{toc}}

Introduction
============

A friendly introduction to the subject area

-   one
-   two
    -   three

1.  one
2.  two
    1.  three

Scope
=====

What’s in scope
---------------

**Precise statements of what we are considering in this section**

The policy architecture, defining location of policy elements, where and how policies are stored on each device, how to isolate trusted components.
The definition of policy interaction points, where policy interacts with API and the system in general.
The topic of policy synchronisation, update, and cross-device interaction.
The description of policy use cases describing examples of policies and how they will be used.
The subject of policy protection, defining how to guarantee policy authenticity and integrity.
The issue of usability, ensuring the policies remain usable for the end user.
The selection of the best way to represent policies and configuration files.

Whats out of scope
------------------

Explicit statement of things we are holding out of scope, including items we are deferring to phase 2.

The logging of policy requests and responses from the policy enforcement point(?).
How to describe interpersonal relationships in policies.

Review of State of the Art
==========================

Document and evaluate the existing technologies in this space

Policy architecture
-------------------

### XACML architecture (insert an image)

The main components are:
Policy Decision Point (PDP): evaluates whether or not a device API can be accessed by a web application, based on the policy.
Policy Enforcement Point (PEP): allows or prevents access to device APIs.
Policy Information Point (PIP): gathers information to be used by the PDP to evaluate an access control request.
Policy Administration Point (PAP): defines the policy.

### PrimeLife access control architecture (insert a graph)

The PrimeLife XACML Engine is devoted to the evaluation and enforcement of access control, while Data Handling Decision Function (DHDF) provides privacy and data handling functionalities.
The Decision Wrapper component forwards the access request to the AC Manager which is in charge of taking the final decision by combining the PrimeLife XACML access control and the DHDF data handling evaluation results
Both the DHDF and the PrimeLife XACML engines access the Request Context via the Data Reader component and retrieve the information (possibly certified by the Credential System) needed for the evaluation.

### PERMIS (PrivilEge and Role Management Infrastructure Standards Validation)

The PERMIS infrastructure provides facilities for users to manage privileges and authorisation policies and for applications to make authorisation decisions.
PERMIS provides the Attribute Certificate Manager (ACM) and the Bulk Loader for managers to allocate privilege to users. The generated privilege information is stored in X.509 Attribute Certificate format. PERMIS also provides the Delegation Issuing Service (DIS), which allows users to delegate (a subset of) their privileges to other users in their domain, according to the site’s delegation policy.
PERMIS provides the Policy Editor to allow administrators to construct authorisation policies for their applications and delegation policies for their Delegation Issuing Service. The policies are created in XML format, and may then be optionally protected by encapsulating in an X.509 policy attribute certificate, digitally signed by the administrator.

PERMIS provides a modular policy decision point (PDP) and a credential validation service (CVS).
The policy decision point renders an authorisation decision for a user’s access request, normally in the form of granted or denied. The PDP is responsible for making the authorisation decisions when applications need to verify if a requested operations is authorised or not. The applications is responsible for enforcing the decisions returned from the PDP.
The credential validation service is used to validate if the allocation of privileges is valid or not. (The need for this is due to the fact that privileges may be managed in a distributed manner, thus potentially anybody can allocate any privileges to anyone else, but only some of these allocation will be recognised by the PERMIS CVS as being valid). The CVS returns the set of valid attributes for a user, ready for the PDP to make an authorisation decision.

The underlying architecture of PERMIS is a distributed architecture. Normally the following principals/entities will be involved in the architecture.
1. System Administrators (called Sources of Authority in PERMIS) are principals responsible for composing the rules for the decision making and credential validation services. These rules are kept as policies.
2. Attribute Administrators or Attribute Authorities (AAs) issue attributes to users. These attributes are normally used to associate users with roles. Thus with the issued attributes, PERMIS can know what roles a user has been assigned to. Attributes will be managed in the form of credentials.
3. Users are the principals that perform operations on the protected resources. Users can be human beings or applications.
4. Applications are the programs that do useful things for users and provide users with interfaces to access protected resources. Applications will need to intercept the users’ request to access protected resources, and solicit authorisation decisions from PERMIS. The application will then need to enforce the authorisation decisions returned by PERMIS. This enforcement is normally to reject the user’s request to access the resource if the authorisation decision is "denied" and to allow access to the resource is the decision is "granted".
5. Resources are valuable computer based resources that need to be protected from being wasted, damaged or used improperly by users.

System administrators will write authorisation policies, specifying what roles have which privileges, and what kind of credentials will be recognized by PERMIS. The authorisation policy will be used by PERMIS for all reasoning regarding authorisation. Attribute administrators will issue credentials to users containing attributes, telling what roles the users have. When a user requests access to a protected resource, the user’s credentials will be analysed by PERMIS, and only those attributes that can be validated by the credential validation rules in the policy will be recognized as valid by PERMIS. Then PERMIS will use the association of attributes and privileges as specified in the policy to render an authorisation decision for the user’s request.

PERMIS authorization infrastructure

<div class="uml">

scale 0.7

actor "Subject Sourcenof Authority" as ssoa
actor "AttributenAuthority" as aa
participant "Subject" as s
participant "SubjetnPEP" as spep
participant "Subjectnenvironment" as se
participant "SubjectnPDP" as spdp
participant "CredentialnIssuingnService" as cis
participant "AttributenRepository" as ar
participant "TargetnPEP" as tpep
participant "CredentialnValidationnService" as cvs
participant "Targetnenvironment" as te
participant "TargetnPDP" as tpdp
participant "ObligationnService" as os
participant "Target" as t
actor "Target Sourcenof Authority" as tsoa

autonumber 0
ssoa -> spdp : policies stored in Subject PDP
autonumber 0
aa -> cis : policies stored in Credential Issuing System
autonumber 0
tsoa -> cvs : policies stored in Credential Validation System
autonumber 0
tsoa -> tpdp : policies stored in Target PDP

s -> spep : applicationnrequest
se -> spep : environmentalninformationntranmsission
spep -> spdp : attributes inclusionnpolicies check
spdp -> spep : attributes inclusionnpolicies response

alt Credentials collected from the CIS
 spep -> cis : credentials retrieval
 cis -> spep : credentials transmission
else Credentials collected form the AR
 autonumber 5
 spep -> ar : credentials retrieval
 ar -> spep : credentials transmission
end

spep -> tpep : request transfer
tpep -> cvs : credentialsnvalidation

alt additional credentials pull form CIS
 cvs -> cis : credentials retrieval
 cis -> cvs : credentials transmission
else additional credential pull form AR
 autonumber 9
 cvs -> ar : credentials retrieval
 ar -> cvs : credentials transmission
end

cvs -> tpep : valid attributesntransmission
te -> tpep : environmental informationntransmission
tpep -> tpdp : access control check
tpdp -> tpep : access control response
tpep -> os : obligations enforcement
tpep -> t : request allowed

</div>
Step 0 is the initialization step for the infrastructure, when the policies are created and stored in the various components. Each subject may possess a set of credentials from many different Attribute Authorities (AAs), that may be pre-issued, long lived and stored in a repository or short lived and issued on demand, according to their Credential Issuing Policies. The Subject Source of Authority (SOA) dictates which of these credentials can leave the subject domain for each target domain.
When a subject issues an application request (step 1), environmental informations are collected (step 2) and then the application independent policy decision point (PDP) informs the applicationâ€™s policy enforcement point (PEP) which credentials to include with the userâ€™s request (steps 3-4).
These are then collected from the Credential Issuing Service (CIS) or Attribute Repository by the PEP (steps 5-6). The userâ€™s request is transferred to the target site (step 7) where the target SOA has already initialized the Credential Validation Policy that says which credentials from which issuing AAs are trusted by the target site, and the Access Control policy that says which privileges are given to which attributes.
The userâ€™s credentials are first validated (step 8). This may require the CVS to pull additional credentials from an AAâ€™s repository or issuing service (step 9-10).
The valid attributes are returned to the PEP (step 11), combined with any environmental information, such as current date and time (step 12), and then passed to the PDP for an access control decision (step 13-14).
If the decision is granted the userâ€™s request is allowed by the PEP (step 16), otherwise it is rejected. In either case, the PDP may also return a set of obligations, which are actions that the PEP must enforce along with the access control decision (step 15).

Policy Interaction Points
-------------------------

### Common browser implementations

#### Secure capabilities

A brief survey of the security settings in a typical web browser gives an overview of the typical controls a user directly or indirectly can impose over a classic web pages execution
* Cookie settings: inhibits a web pages ability to use this general resource. Different flavours of cookie restrictions are:
**** Don’t write any cookies
**** Don’t read any cookies
**** Clear cookies on browser exit
* Images: option to stop the presentation of images. More of an optimisation that a security setting, however the default permissions of a web page being able to present resources (images) form another domain, may introduce some limited security concerns
* JavaScript: generally a coarse grained option to stop Javascript working full stop. Note however that due the high prevalence of JavaScript in modern webpages, turning this option off, would make many pages almost unusable
* Extensions: different browser have different plugin technologies (ActiveX, Mozilla plugins, Chrome plugins etc). All browsers present the ability to turn this off however.
* Location: the modem W3C define Geolocation API can make the devices location visible to the browser. This setting prevent this from happening
* History/Bookmarks: stops the browser recording the history of sites visited.
* Notifications: some modern browsers all a web page to present a notification to the user that is visible outside of the normal chrome window. This option inhibits this capability.
* File download: file download is a common scenario from a browser. Downloading and mp3 presents limited security risk; downloading an executable file presents a large risk. This option give the browser control over whether this should be enabled, disabled or prompted for.
* Popup windows: pop windows can be trigged by the common openwindow api. Some sites abuse this capability, creating may undesirable popups. This setting is a more recent introduction, to limit this
* Data sources cross domains: principally refers to the ability for a website to request, via XMLHTTPRequest data from a site under a different domain. This powerful feature brings with it some general security weaknesses, a form of cross site scripting attach. Setting this option essentially enforces the CORS W3C restriction.
* Frame behaviors
* Form encryption on submission: a less used option is the ability for browser to enforce the fact that data submitted via form must be encrypted before it reaches the browser
* Clipboard access: can restrict or allow a browser to interact with the current clipboard
* Automatic logon: many browser support auto login features, as a usability enhancement. This setting can determine, if and sometimes how (what cached credentials are used) this works.
* Form field caching (remember password): another UI enhancement that some browsers have introduced, allows a browser to save common form fields and autopopulate them, when it sees similar fields in the future. This setting can inhibit this behaviour.
* Report/Block malicious sites: a feature more common in anti virus and internet security products, is a live monitor that watches sites visited and advises (or blocks) access to suspect sites. Some of this functionality is slowly being absorbed into the browser itself. This policy setting controls this behaviour.
* Restrict HTTPS sites to view HTTPS content: if a site is hosted on a secure connection, in order to not compromise this security, all content (scripts and images) should also be served from a secure site. THis setting controls this behaviour.
* HTML5: discussed in greater depth below, are policy setting that mediate access to security sensitive HTML5 APIs, such as local storage

Almost every one of the elements described above could be described as an element of Policy. It is a rule, that represents the users preference of whether certain security sensitive capabilities or APIs should be accessible to an application. It is also important to note that no current browser allow these settings to be shared with other browsers or other devices. A scenario which is at the heart of many webinos use cases

#### Zones

One of the contextual elements that determines whether an application is allowed access to secure capabilities is it provenance. In classic browsing, provenance is determined by domain of origin.

Almost all current browser implement a mechanism via which domains can be clustered into different zones, that represent different trust levels. Often these can be configured but typical zones may be

-   Local network
-   Intranet
-   Public internet
-   Trusted zones.

NOTE: due to know DNS weaknesses (see work on WP 2.8) only applications/websites hosted on TLS/HTTPS domains, have trusted provenance

#### Effects

When an application from a particular zone attempts to access a particular capability it will result in a predetermined effect
Most current browsers offer three distinct effects

* Enable
 * Deny
 * Prompt

### W3C standardised policy mechanisms

#### SameDomain origin policy

Refeences http://www.w3.org/Security/wiki/Same_Origin_Policy http://www.mozilla.org/projects/security/components/jssec.html .

The same domain origin policy does not seems to be be **standardised** per se, but is a number of commonly understood implementation conventions that have evolved to protect againt common attacks. Originally developed by Mozilla, its conventions have not propogated onto most other browser implementations.
The principle attack it tries to mitigate, is described in the W3C document, linked
 The prohibition on receiving information is intended to prevent malicious web sites from reading confidential information from other web sites, but also prevents web content from legitimately reading information offered by other web sites. Under the same-origin policy, cross-site sending of information is also dangerous since it enables attacks such as cross-site request forgery (CSRF) and clickjackin
Practically a same domain origin policy:
* Prevents XHR from one domain to another
* Allows <script tags to be included from one domain to another
* Allows CSS files from one domain to another
* Allows images from one domain to another

#### CORS

http://www.w3.org/TR/cors/
CORS is a set of conventions (new standard) that establishes a level of trust between two domains, which exempts the pages from the same domain policy

### Signed Script Policy

#### WARP

WARP is a specification that relates to the widget family of specifications.
If a widget were to fall under the same-domain origin policy (as defined above), it would be highly restricted, as it could not effectively communicate with remote web sites via XHR. Conversely, the ability to download scripts (via script tags) from any domain introduces quite serious risks, when a widget is presumed to be trusted, locally installed and has access to sensitive apis.
The WARP specification provides a way for a widget developer (or anyone who has access to the widget before signing) to explicitly define their expectations of dependency on other domains. Unlike same domain policy, WARP applies to all of
* XHR
* Script tags
* CSS inclusions
* Images
WARP is a policy of least privilege, in that it is declared by the application author (or their proxy) and the privilege for the
It is therefore principally an protection against exploitation.

#### Widget Feature

Widget feature is another element declared explicitly by the widget author in the widget configuration file.
Like WARP it is another least privilege policy element.
Unlike WARP instead of restricting or allowing access to network resources, feature declaration is a more general mechanism for declaring access to an extensible resource.
For WAC and BONDI implementations these resources are generally local device APIs

#### WAC and BONDI policy interaction points

The WAC and BONDI models both have the same fundamental design, being based upon the xacml model
The principles are relatively straight forward.
A policy is made up of a many rules, that can be combined and modified in a number or ways.
Each policy element has a target which essentially defines a list of applicable elements.
Formally within the XACML model that bondi and WAC uses these elements are subjects, in the BONDI model, these subjects can be:
* Widget identifiers (normally certificate induced) OR
* Website identifies (URI)
WAC however is slightly more limited and subjects are only:
* Widget identifiers.
The target element defines a coarse grained applicability or resource requesting identities. Once this scope is identified applicable rules are evaluated and applied.
A rule can consist of three elements
* Subject match: Widget or web page
* Resource match: the specific thing being accessed - eg. an API
* Environment match: background variable, such as network, time
But as a brief summary this means the following entities and resources can be currently intercepted by the security policy
* Application requesting access, which can be:
**** A website, hosted on a web server, which can be identified by
*** domain
*** certain characteristics pertaining to is certificate
**** A widget, installed locally on device, which can be identified by
*** its name
*** characteristics of either its author or distributor certificate
*** the domain from which it was installed
* The environment, currently limited to
** is the device currently roaming
**** what bearer is the device connected to
* Resource, the thing being accessed, which can be
**** API feature, a developer centric, specific API which can be access
**** Device capability, and user centric classification of sensitive feature that is being access

API feature, and device capability, are essentially orthogonal, classifications of the same capability sets being accessed.
Note: when WAC revised the BONDI specifications, the API feature was dropped, now it is only possible to write policies that refer to device capabilities.
Device capabilities also support the concept of device capability parameters. These are dynamic variable dynamically evaluated in context when a feature is triggered. In other words they are the security relevant parameters passed to a function, which can be intercepted, evaluated and processed logically within the rules set, by the policy module.
In addition to the device capability and API feature resources, BONDI supports the following APIs which do not map 1:1 to a extended JavaScript extension
* Background operation: indicates that the application continues to function and run in the background
* Hidden operation: indicates that the application can run in the background
* Persistent storage: indicate that the application can make use widget specific persistent storage
* Network utilisation: indicates that the widget is making substantial or frequent use of the network.
* Network access: indicates the type of network access that is to be allowed by the security policy

### Policy Protections

#### Bondi

In BONDI policies are stored in xml fragments secured by the XML Signature Syntax and Processing (Second Edition) [http://www.w3.org/TR/xmldsig-core/]. This document specifies XML digital signature processing rules and syntax. XML Signatures provide integrity, message authentication, and/or signer authentication services for data of any type, whether located within the XML that includes the signature or elsewhere.

Recommendations from state of the art
=====================================

Make some conclusions on what aspects of state of the art we can use

In literature exists some well known and practically used standards. Build policy architecture starting from the XACML one and extending it with PrimeLife elements seems appropriate in the webinos context.

the use of XML configuration file to express application requirements and extend it defining webinos-specific tags could be appropriate to allow flexibility and extensibility.

As basic security measure, signature of policy files is required to grand policies integrity.

Conceptual Architecture
=======================

High level conceptual architectural proposal of the approach

This includes diagrams of the architecture and the aims of the proposal. So:

-   XACML/Primelife style policy architecture

Policy architecture derived fom XACML only (insert graph from http://dev.webinos.org/redmine/projects/wp3-1/wiki/Policy_Architecture).
The standard XACML architecture is extended with the W-Agent, which allows local components to communicate with the ones in the Webinos Cloud, and the PEP to receive remote access requests.

Policy architecture derived fom XACML and extended with PrimeLife components (insert graph from http://dev.webinos.org/redmine/projects/wp3-1/wiki/Policy_Architecture).
Compared to the first architecture, it’s introduced the DHDF for data-handling policies, some abstraction component (Decision Wrapper, Data Reader) and the Credential System.

-   Synchronised policies between devices

If we assume to have a policy authority, the authority can also serve as synchronizer.
Any device could have the authority public key (e.g. embedded at manufacturing time, or inserted by the distributor) for authentication and confidentiality purposes.
When the authority is not available, or when we have customized policies, derived form user preferences, policies can be exchanged among devices of the same personal zone.
Assuming to have a pre shared zone key, policy exchange can occur using a secure channel.

Another alternative, in case of no Policy authority, each device can have a white list from which accept policy changes (however, without some signature or authentication, no policy integrity can be assured).

Technical Use Cases
===================

Discrete technical use cases that unfold the requirements one by one.

Examples drawn from the Privileged Applications area [[‘Privilege_Apps_and_Services_Usecases_Requirements_Sequence_Diagram’]], the [[Policy_Cross_Device]] page, and the [[Policy_Elements]] page.

Here are depicted and briefly presented use-cases particularly relevant for policy sub-task.

WOS-UC-TA8-002: Interpreting policies and making access control decisions
-------------------------------------------------------------------------

Normal Flow
Pre-Condition
The User has a tablet PC running webinos.
The User has a photo collection on his tablet PC which he would like to share with other people.
The webinos platform has a set of policies installed. These are not contradictory â€“ a decision can always be taken based on their content.
Flow
1. The User has installed a new photo-sharing Application.
2. The photo-sharing Application automatically tries to upload his photos to a shared repository.
3. Accessing photos stored on the webinos Device â€“ his tablet pc â€“ results in an access-control request to the webinos platform.
4. webinos takes the event (Application X accessing File F) and checks against the set of policies (PS) installed.
5. The policies allow this action, and the photo-sharing app resumes uploading photos.
Post-Condition
The correct access control decision is taken with respect to all policies.

Alternate Flow (optional)
Pre-Condition
Same as normal flow.
Post-Condition
5. The policies do not allow this action and the Application is not able to upload any files.
6. The Application fails gracefully, informing the User of why it is unable to complete the request.
7. The access control decision is logged.

Alternate Flow (optional)
Pre-Condition
Same as normal flow.
Post-Condition
5. The policies require an extra condition before allowing this action: in this case, requesting User input to confirm that this behavior is permitted.
6. webinos prompts the User to confirm that access to photos is allowed.
7. The User agrees.
8. The photo-sharing Application resumes uploading photos.

WOS-UC-TA8-003: Enforcing multiple policies on multiple devices (normal flow)
-----------------------------------------------------------------------------

Normal Flow
Flow
1. The User has a Mobile phone and an in-car entertainment System.
2. The User decides that he does not want to alert local networks to his presence.
3. He uses webinos to specify that his Devices should remain hidden and not discoverable. He does this on his Mobile phone.
Post-Condition
Any webinos Device used by the User subsequently will not be discoverable by a remote network. This includes his car whenever he is using it.

Alternate Flow
Pre-Condition
A User has both personal and work photos on his webinos Device.
Flow
1. The User uses a Mobile phone provided by his company, a professional photography business.
2. He has configured it to allow him to share personal information with certain social networking Applications.
3. One of the Applications encourages the sharing of personal photos.
4. He does not see a problem with sharing the photos on his Device, and proceeds, allowing the potential upload of all photos on his Device.
5. However, the company policy protects all the photos owned by the company, many of which he has inadvertently given permission to. These are forbidden from being used by non-trusted Applications.
6. The webinos policy engine interprets the Userâ€™s policy and the company policy â€“ knowing that the company, as the phoneâ€™s owner, takes precedence â€“ and denies access to the relevant photos.
Post-Condition
The User can only share his own photos with his social network Application, not any of the companyâ€™s copyrighted photos.

WOS-UC-TA8-007: Policy authoring tools
--------------------------------------

Normal Flow
Pre-Condition
The Developerâ€™s company has ownership of company Devices and is able to set policies which cannot be overridden by the End Users.
Flow
1. The Developer knows that webinos policies are written in a standard language and he downloads a webinos policy editing tools to help him create a suitable policy for his requirements.
2. He uses the tool to select the class of assets which she is concerned about â€“ all data owned by the company.
3. He then sets a mandatory policy that this data is not allowed to be shared with any Application not signed by the company. All access to the data should also be logged.
4. He also selects a default policy for personal data, stating that it should not be shared with Applications by default.
5. The Developer modifies various other settings until he is happy with the policy.
6. The tool provides several examples of how his policy would be applied, and what it allows and denies access to.
7. He then tests his policy against several example Device configurations that the tool supports. This shows him that Devices using his policy would still be able to run, but would not be able to access company data.
8. He saves the policy and signs it to mark it as a trusted company policy.
Post-Condition
The company policy can be applied to all Devices the company owns and will control webinos Applications in the ways defined by the Developer.

Alternate Flow
Flow
7. The Developer tests the policy and realizes that it prevents Applications from accessing any data on the Devices. This is shown to him using the policy tool.
8. He realizes his mistake and modifies the policy suitably.

Here some further use-cases whose aim is to highlight policy interactions.

Cross-Device Policy Synchronisation
-----------------------------------

Installing an app (‘A’) on device ‘D’, granting it permissions, and then wanting to allow it to use device ‘E’
 * Assume device ‘D’ and ‘E’ are used only by the user Justin.
 * Justin "installs" ‘A’ on ‘D’.
 * At end of install process, after granting the application some permissions, Justin is prompted "This application can be used on multiple devices. Install on [list of user devices and tick box]?"
 * Justin selects that the application should be installed on device ‘E’ as well.
 * Prompt: "Give application permission to access the same resources? / Customise permissions / Ask me later?"
 * Justin clicks "give same resources"
 * Webinos runtime creates a message to device ‘E’ containing instructions for doing this.
 o Name of application, permissions granted on this device
 o Justin’s credentials/signature ? Signature by device in current state?
 * Message queued to be sent on the overlay network to the other device, using a secure transport session. This may happen immediately if possible (e.g. if device ‘D’ is a home server) or may wait for a proximity event, or may be queued on a cloud service waiting for the user to interact with device ‘D’ in the future.

Using device ‘D’ to remove permission for app ‘A’ to access resource ‘R’ on all devices (Device ‘D’ and ‘E’)
 * Peter has been using app ‘A’ and decides he doesn’t trust it after being told by a friend that it sends data to advertisers.
 * He is using device ‘D’, as this is his main device
 * He navigates to the policy management area (or maybe he right-clicks on the application icon) and selects "remove".
 * He is asked whether he wants it to be removed across all of his devices (a list of his local devices might be selected) and he clicks on all of them.
 * Webinos runtime generates an update message to each device in his cloud, including device ‘E’, in a secure manner:
 o "Remove app", app name
 o user credentials, device credentials
 o ^^ all signed
 * These are sent when the device is able to connect to other devices and when these devices are capable of authenticating themselves
 * Depending on the device security policies, the deletion may happen automatically, or the app might be isolated and require local permission to delete?

Using device ‘D’ to authorise app ‘A’ to access resource ‘P’ on device ‘E’ (E and D owned by the same user)
Using device ‘D’ to authorise app ‘A’ to access resource ‘P’ on device ‘E’ (E and D owned by different users)
 * Helen is using app ‘A’ and wants to use it to access her friend Gloria’s photos on device ‘D’.
 * She selects to discover other devices, and finds Gloria’s device ‘D’
 * She requests access to photos on ‘D’.
 * Gloria’s device prompts Gloria to allow this and present’s Alice’s device details, as well as the history of communication with this device.
 * Gloria approves the communication
 * Gloria’s runtime adds a temporary permission for the photo app (resource ‘P’) on Gloria’s phone

Updating labels on stored user data - marking some as ‘private’ on device ‘D’ and having the same data on device ‘E’ automatically tagged.
 * Gloria decides to make sure her personal data is being protected appropriately
 * She looks at her webinos device to see what data about her is known
 * Some data is marked as "private" and other data is not.
 * She notes that her "place of work" is listed but not marked as private
 * She tags this data as "private" and therefore all policies apply to it that apply to other private data.
 * She tells webinos to update this setting on all her devices
 * Webinos queues a policy update for device ‘E’:
 o Update policy, data item, new XACML
 o User credentials, device credentials
 o ^^ all signed

Registering device ‘F’ as being a trusted device with respect to device ‘D’ and device ‘E’
 * Anna has just bought a new tablet PC (‘F’), and would like it to automatically synchronise with other devices
 * She uses it to discover her mobile phone (‘D’), a webinos device.
 * On discovery, she selects the mobile phone symbol and choses to join the "local webinos device cloud"
 * Untrusted message from tablet to phone:
 o "device join", device ID
 * This prompts her mobile phone to authenticate her
 * She enters her credentials into the phone
 * The phone adds this device to a "known" and "personal devices" set
 * The tablet PC downloads the relevant set of policies (as well as profile info - out of scope ) from the mobile phone and applies them. This includes the identity of other devices in the cloud.
 o Should be a set of "policy update" messages?

Policy Example and Elements
---------------------------

User U wants to install Application A and grant it access to APIs J0-J9
User U wants to grant Application A access to APIs J0-J9, but only on device M
User U wants to grant Application A access to APIs J0-J9, on device M and N. He does this through device M.
User U wants to use Application A under a work pseudonym and Application B under his personal pseudonym. Both are on the same device M.
User U wants to share his photos (P0-P99) with User V.
Application A wants to use services provided by Application B, hosted somewhere else.
Application A wants to use services provided by Application B, also present on the same device M.
User U works for Company MegaCorp who want to have remote access to work data items W0-W99.
User U wants to restrict Application A from using network N.
User U wants Application A to work using network N when he is at MegaCorp and wants to use network L when he is at home.
User U wants third party S to manage his policy settings on his device M
User U wants third party S to manage his policy settings on all his devices: M, N and O.
User U is not allowed to install applications on device M.
Application A wants a particular type of authenticated credentials from the User
Developer D1 wants to update the required access control policy for application A as part of an upgrade.
Application A1 wants to access (historic) context information provided by service/sensor S1 on device M.

Sequence diagram analysis
=========================

Sequence diagram analysis that reconciles the conceptual architecture with the user cases, eliciting issues as we go

This might be useful from a number of perspectives: application developer, user install, use, install extension, revoke access, etc.

### WOS-UC-TA8-002: Interpreting policies and making access control decisions

<div class="uml">

title usecase WOS-UV-TA8-002

actor "User" as usr

participant "photo-sharingnapplication" as app
participant "PEP" as pep
participant "PDP" as pdp
participant "sharednrepository" as rep

autonumber
note over usr
 this entity includes
 both the real user and
 the webinos front-end
end note

app -> pep : photos upload attempt
pep -> pdp : policies check

alt normal flow
 note over pep, pdp
 policies allow photo upload
 end note
 pdp -> pep : operation granted
 pep -> app : action allowed
 app -> rep : photos upload
else alternate flow
 autonumber 3
 note over pep, pdp
 policies do not allow photo upload
 end note
 pdp -> pep : operation denied
 pep -> app : action not allowed
 app -> usr : upload aborted
 note over usr, app
 the access control
 decision is logged
 end note
else alternate flow
 autonumber 3
 note over pep, pdp
 policies require user confirm
 before allowing photo upload
 end note
 pdp -> pep : confirm requested
 pep -> usr : ask for confirm
 usr -> pep : operation granted
 pep -> app : action allowed
 app -> rep : photos upload
end

</div>
### WOS-UC-TA8-003: Enforcing multiple policies on multiple devices (normal flow)

<div class="uml">

title usecase WOS-UV-TA8-003nnormal flow

actor "User" as usr
participant "mobile privacyndashboard" as mobile_pd
participant "mobile discoverynservice" as mobile_sd
participant "mobilenPEP" as mobile_pep
participant "mobilenPDP" as mobile_pdp
participant "cloudnPDPC" as cloud_pdpc
participant "in-carnPDP" as car_pdp
participant "in-carnPEP" as car_pep
participant "in-car discoverynservice" as car_sd

autonumber

usr -> mobile_pd : set hidden mode
mobile_pd -> mobile_pep : privacy setting modification attempt
mobile_pep -> mobile_pdp : policies check
mobile_pdp -> mobile_pep : operation granted
mobile_pep -> mobile_pd : action allowed
mobile_pd -> mobile_pdp : new privacy settings
note over mobile_pdp, cloud_pdpc
 through mobile PDPC
 and mobile W-Agent
end note
mobile_pdp -> cloud_pdpc : policy update
note over cloud_pdpc, car_pdp
 through in-car W-Agent
 and in-car PDPC
end note
cloud_pdpc -> car_pdp : policy update

 mobile discovery 

note over mobile_pdp
 assumption: a hello message arrives to the discovery service
 alternative assumption: the PEP may recognize a hello message and filter
 it accordingly to the policy, avoiding to send it to the discovery service
end note

note over mobile_sd
 a nearby device tries
 to sense the mobile
end note

mobile_sd -> mobile_pep : discovery attempt
mobile_pep -> mobile_pdp : policies check
mobile_pdp -> mobile_pep : operation denied
mobile_pep -> mobile_sd : action not allowed

 in-car system discovery

note over car_sd
 a nearby device tries to
 sense the in-car system
end note

car_sd -> car_pep : discovery attempt
car_pep -> car_pdp : policies check
car_pdp -> car_pep : operation denied
car_pep -> car_sd : action not allowed

</div>
### WOS-UC-TA8-003: Enforcing multiple policies on multiple devices (alternative flow)

<div class="uml">

title usecase WOS-UV-TA8-003nalternate flow

actor "User" as usr
participant "photo-sharingnapplication" as app
participant "PEP" as pep
participant "PDP" as pdp
participant "sharednrepository" as rep

autonumber

note over pdp
 in PDP there are user
 policies and company
 policies.
 company policies can
 be provided by a
 policy authority or
 manually inserted
end note

app -> pep : photos upload attempt
pep -> pdp : policies check
pdp -> usr : ask for permission
usr -> pdp : photo sharing allowed
note over pdp : user policies andncompany policiesncomparison
pdp -> pep : operation partially granted
pep -> app : action partially allowed
app -> rep : personal photos uploaded

</div>
### WOS-UC-TA8-007: Policy authoring tools

<div class="uml">

actor "developer" as dev
participant "policy tool" as tool
participant "PEP" as pep
participant "PDP" as pdp

autonumber

note over tool
 assumption: policies are tested into the
 device and not into a policy tool environment
end note

dev -> tool : set up company policies
tool -> pep : policies modification attempt

pep -> pdp : policies check
pdp -> pep : operation granted
pep -> tool : action allowed
tool -> pdp : new policies set up

 test 

dev -> tool : company data sharing test
tool -> pep : share company data
pep -> pdp : policies check
pdp -> pep : operation denied
pep -> tool : action not allowed
tool -> dev : company data sharing not allowed

dev -> tool : personal data sharing test
tool -> pep : share personal data
pep -> pdp : policies check

alt normal flow
 pdp -> pep : operation granted
 pep -> tool : action allowed
 tool -> dev : personal data sharing allowed
 note over dev, tool
 Test succesfull. The developer saves
 the policy and signs it to mark it
 as a trusted company policy
 end note
else alternate flow
 autonumber 16
 pdp -> pep : operation denied
 pep -> tool : action not allowed
 tool -> dev : personal data sharing not allowed
 note over dev, tool
 Test unsuccesfull. The developer
 modifies policies
 end note
end

</div>
More diagrams here?

Some explanation on diagrams?

### Privilege Apps and Services (Access Control)

[[3.1_Deliverable_Specifications_Privileged_Apps]]

Formal Specification
====================

This section is where we get into formal specification and architecture

NOTE: when it comes to formal specification the distinctions between the subject areas may collapse

architecture components
-----------------------

Simple XACML-like architecture

<div class="uml">

WebinosRuntime o— DeviceAPIs
WebinosRuntime o— PEP
WebinosRuntime o— LocalData
WebinosRuntime o— Comms
WebinosRuntime o— Apps

Apps --> PEP

PEP--> LocalData
PEP --> Comms
PEP--> DeviceAPIs

PEP "1" - "1" PDP
PDP "1" - PAP
PAP "1" — "*" XACMLPolicy

</div>
Multi-Device Distributed Structure
==================================

-   Added PDPC, PIP and PAP communication with webinos network (Problem: synchronization)

A rough sketch:

![](webinos-diagram-policy.jpg)

Data flow (XACML only)
----------------------

"Architecture Proposal (data-flow)":http://dev.webinos.org/redmine/attachments/download/428/policy_management__architecture.odp

{{graphviz(
digraph G {
"RemotenAccessnRequestorn(W-Agent)"[shape=box]
"Access Requestor"[shape=box]
"Overlay Network"[shape=ellipse]
"Webinos CloudnPDPC - PIP - PAP"[shape=ellipse]
node [shape=box, fillcolor=lightgray, style="filled, rounded"]
{rank = same; "Access Requestor"; "PEP"; "obligations"}
{rank = same; "PDP"; "Context Handler"; "PIP"}
{rank = same; "PDPC"; "Resources"; "Subjects"; "Environment"}
{rank = same; "PAP"; "W-Agent"; "Webinos CloudnPDPC- PIP - PAP"}

"RemotenAccessnRequestorn(W-Agent)" -> "Overlay Network" -> "W-agent" -> "PEP"
"Access Requestor" -> "PEP" -> "obligations"
"PEP" -> "Context Handler"
"PDP" -> "Context Handler" [dir=both]
"Context Handler" -> "PIP"
"Resources" -> "Context Handler"
"PDP" -> "PDPC"
"PIP" -> "Resources"
"PIP" -> "Subjects"
"PIP" -> "Environment"
"PDP" -> "PAP" [dir=both]
"PDPC" -> "W-Agent" [dir=both]
"PAP" -> "W-Agent" [dir=both]
"PIP" -> "W-Agent" [dir=both]
"W-Agent" -> "Webinos CloudnPDPC- PIP - PAP" [dir=both]
}

</div>
Distributed Architecture Based on PrimeLife (XACML+PRIME extensions)
====================================================================

-   Similar to the distribuited XACML-like version proposed above, but integrated in a PrimeLife architecture
-   Introduction of DHDF for data-handling policies
-   Introduction of some abstraction components (Decision Wrapper, Data Reader)
-   Intrduction of Credential System

Motivations behind this choice:
-------------------------------

-   Negotiation (PIP indentifying missing attributes needed, incremental evalutation of access control policies, minimal disclosure)
-   Credential-based restrictions (digital credential and certified attributes)
-   Data-handling policies (in addition to the traditional XACML access control policies), e.g. privacy policies defined user-side, privacy level handling
-   Legislation support (EU privacy directives)
-   Open-source European Project

Data flow (XAMCL extended with PrimeLife)
-----------------------------------------

{{graphviz(
digraph G {
"RemotenAccessnRequestorn(W-Agent)"[shape=box]
"Access Requestor"[shape=box]
"CredentialnSystem"[shape=box]
"Overlay Network"[shape=ellipse]
"Webinos CloudnPDPC - PIP - PAP"[shape=ellipse]
node [shape=box, fillcolor=lightgray, style="filled, rounded"]
{rank = same; "Access Requestor"; "Decision Wrapper"}
{rank = same; "DHDFnEngine"; "Access Manager"}
{rank = same; "PEP"; "obligations"}
{rank = same; "Context Handler"; "PDP"; "PDPC"}
{rank = same; "PIP"; "W-Agent"; "Webinos CloudnPDPC- PIP - PAP"}
{rank = same; "Data Reader"; "RequestnContext"; "CredentialnSystem"}

"RemotenAccessnRequestorn(W-Agent)" -> "Overlay Network" -> "W-agent" -> "Decision Wrapper"
"Access Requestor" -> "Decision Wrapper"
"Decision Wrapper" -> "Access Manager"
"DHDFnEngine" -> "Access Manager" [dir=back]
"Access Manager" -> "PEP" -> "obligations"

"PEP" -> "Context Handler"
"PIP" -> "Context Handler" [dir=back]
"Context Handler" -> "PDP" [dir=both]
"PDP" -> "PDPC"
"PDP" -> "PAP" [dir=both]
"PDPC" -> "W-Agent" [dir=both]
"PAP" -> "W-Agent" [dir=both]
"PIP" -> "W-Agent" -> "Webinos CloudnPDPC- PIP - PAP" [dir=both]
"PIP" -> "Data Reader"
"DHDFnEngine" -> "Data Reader"
"Data Reader" -> "RequestnContext"
"RequestnContext" -> "CredentialnSystem" [dir=back]
}

</div>
UML components analysis
-----------------------

Detail the specifics of the individual components required, using UML and accompanying prose.

UML sequence analysis
---------------------

Using sequence and state diagrams describe the behaviour of the system
and define and algorithmic elements

Functional and non functional requirements
------------------------------------------

A holding place for any formal requirements (not easily testable or provably interoperable) that are not part of the specification.

Identity
--------

### webinos component identification

  ------------------ ---------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------
  _.ReqID       _.Requirement                                                                                                                             _.References
  ID-USR-Oxford-20   The webinos Runtime SHALL maintain a record of the user and device identifiers that are allowed to make use of device capabilities remotely.   WOS-UC-TA1-001: Virtual Device
  ------------------ ---------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------

### webinos component authentication

  ------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------ ----------------------------------------------------
  _.ReqID        _.Requirement                                                                                                                                           _.References
  ID-DWP-POLITO-101   Simple authentication at least, and mutual authentication at best, SHALL be assured between webinos Components (e.g. applications and the webinos runtime)   WOS-UC-TA1-007: Linking device to a user account
  ID-DEV-POLITO-004   An Application SHOULD be able to unambiguously authenticate itself to authorized entities (e.g webinos runtime)                                              WOS-UC-Ta1-002: Network Independent Virtual Device
  ID-DEV-POLITO-017   An application SHOULD be able to unambiguously prove its developer’s identity                                                                                WOS-UC-Ta1-002: Network Independent Virtual Device
  ID-DEV-POLITO-018   An application SHOULD be able to unambiguously prove its application provider’s identity                                                                     WOS-UC-Ta1-002: Network Independent Virtual Device
  ------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------ ----------------------------------------------------

### webinos component integrity

  ------------------- ------------------------------------------------------------------------------- ------------------------------------------
  _.ReqID        _.Requirement                                                              _.References
  ID-DWP-POLITO-102   Proof of webinos component integrity SHOULD be provided to authorized parties   WOS-UC-Ta1-003: Virtual Device Ownership
  ------------------- ------------------------------------------------------------------------------- ------------------------------------------

### Privacy Management

|_.ReqID |_.Requirement |_.References |
|ID-USR-POLITO-103 | Leakage of identity information during authentication MUST and during communication phases SHOULD be avoided | WOS-UC-TA1-007: Linking device to a user account |
|ID-USR-DT-02 | The webinos System MUST minimize exposure of personal individual identifiers or canonical identifiers of webinos entities | WOS-UC-TA1-007: Linking device to a user account
WOS-UC-TA9-014: End user cross platform privacy analytics in healthcare, smart grids and home environments |
|ID-USR-POLITO-010 | A webinos entity SHOULD be able to identify itself to a webinos application using an astraction (such as a Pseudonym) that is not directly linkable to an existing the unique identifier of the entity (such as a canonical device ID). | WOS-UC-TA1-007: Linking device to a user account |
|ID-USR-POLITO-011 | A user MAY disable the advertising of its identity to webinos components and remote applications | WOS-UC-TA1-006: Pairing a new device to clone settings |
|ID-USR-POLITO-013 | A user SHOULD be able to choose the acceptable identity "privacy level" for other webinos enabled devices that are trying to communicate with his own device | WOS-UC-TA1-006: Pairing a new device to clone settings |
|ID-DWP-POLITO-014 | The communication between devices at non mutually acceptable identity "privacy level" MUST be avoided | WOS-UC-TA1-006: Pairing a new device to clone settings |

Discovery and Addressing
------------------------

|_.ReqID |_.Requirement |_.References |
|DA-DEV-ISMB-004 | It SHALL be possible to address sensors and actuators that does not provide webinos support. | 1.1.5. WOS-UC-Ta1-005: Sensors and Actuators |
|DA-DEV-NTUA-002 | webinos SHALL provide the means to Applications to identify an event occurring in a device. | 7.1.1. WOS-UC-TA7-001: Device Based Context Retrieval
7.1.2. WOS-UC-TA7-002: Event Based Context Retrieval |

Remote Notifications and Messaging
----------------------------------

### Eventing System

|_.ReqID |_.Requirement |_.References |
|NM-DEV-FOKUS-001 | It SHALL be possible to exchange information between multiple entities in terms of events. | |
|NM-DEV-FOKUS-002 | It SHALL be possible to subscribe to specific event types in order to get notified if the related event occurs. | |
|NM-DEV-FOKUS-003 | It SHALL be possible to subscribe to events that are created by a specific entity. | |
|NM-DEV-FOKUS-004 | It SHALL be possible to unsubscribe from notifications aboutspecific event types. | |
|NM-DEV-FOKUS-005 | It SHALL be possible to specify a time limit that defines until when an event should be delivered to its destinations before it is marked as outdated and no further deliveries are tried. | |
|NM-DEV-FOKUS-006 | The originator of an event MAY request notification upon delivery of an event. | |
|NM-DWP-ISMB-001 | Incoming and outgoing messages that are yet to be delivered SHALL be cached. | 1.1.4. WOS-UC-Ta1-004: Communication between webinos Applications |
|NM-DWP-ISMB-003 | webinos SHALL distribute events to all subscribed and authorized destinations. | 1.1.4. WOS-UC-Ta1-004: Communication between webinos Applications
1.2.2. WOS-UC-TA1-011: Continuous monitoring of diabetic’s blood glucose levels
4.1.1. WOS-UC-TA4-001: Subscribe and Publish Events
4.1.6. WOS-UC-TA4-006: Sharing Application States Across Several Devices
4.1.8. WOS-UC-TA4-008: End Session when out of Proximity |
|NM-DWP-ISMB-004 | The webinos system SHALL start/awake applications invoked by/waiting for an event, when it occurs, in a controlled manner. | 4.1.2. WOS-UC-TA4-002: Synchronisation and uploading of data |

### Event description

  ------------------ --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------
  _.ReqID       _.Requirement                                                                                                                                                                _.References
  NM-DEV-FOKUS-101   Events MUST be distinguishable in order to decide if the same event occurred multiple times or the same event was delivered multiple times.                                       
  NM-DEV-FOKUS-102   An event SHALL provide information about its type in order to distinguish between different events.                                                                               
  NM-DEV-FOKUS-103   The type of an event SHALL be either a predefined event (e.g., boot completed, device in standby, new devices available, etc.) or an arbitrary application specific event type.   
  NM-DEV-FOKUS-104   An event MAY provide information about its source, i.e., about the entity that created the event, in order to allow replies.                                                      
  NM-DEV-FOKUS-105   An event MAY specify a set of specific destinations of the event in order to restrict the visibility of the event.                                                                
  NM-DEV-FOKUS-106   It SHALL be possible to optionally attach payload data to events.                                                                                                                 
  NM-DEV-FOKUS-107   The payload data MAY contain arbitrary application specific data.                                                                                                                 
  NM-DEV-FOKUS-108   Events SHALL provide information about the date and time when the event occured resp. when the event was created.                                                                 
  NM-DEV-ISMB-101    Events MAY be associated with event-specific Metadata.                                                                                                                            7.1.11. WOS-UC-TA7-011: Discovering and updating context information of a shared capability
  ------------------ --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------

Policy and Security
-------------------

### Device discovery, communication and authentication

  --------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------------------------------------------------------------
  _.ReqID          _.Requirement                                                                                                                                                                                                                              _.References
  PS-USR-Oxford-103     The webinos Runtime Environment SHALL only allow associations to be made between devices when predefined network security practices are followed, including transport level security, device authentication and user and device authorisation   
  PS-USR-Oxford-104     The webinos runtime SHALL mediate during service discovery and apply appropriate controls where not provided by another layer or protocol for the purpose of enabling and automating privacy and security preferences.                          
  PS-USR-Oxford-16      Users SHALL be alerted of an attempt to authenticate a webinos device with another webinos device, unless a policy overrides this.                                                                                                              WOS-UC-TA1-006
  PS-USR-Oxford-17      The webinos Runtime Environment SHALL be capable of setting dynamic access control policies for device data when initiating an association to another webinos Device.                                                                           WOS-UC-TA4-014: Continuous sharing of a medical file through webinos enabled devices
  PS-USR-Oxford-41      The creation of device discovery policies SHALL support the specification of policies that are conditionally enforced across all of the user’s devices.                                                                                         WOS-UC-TA9-003: Enforcing multiple policies on multiple devices
  -PS-DMA-IBBT-003-   -The webinos runtime SHOULD be able toprovide access to custom API’s to devices-                                                                                                                                                              -WOS-UC-TA3-004-
  PS-USR-POLITO-012     A user MAY choose the "privacy level" of the identity used to advertise other webinos enabled devices.                                                                                                                                        WOS-UC-TA1-006: Pairing a new device to clone settings
  --------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------------------------------------------------------------

### User identification and behaviour

  ------------------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ -------------------
  _.ReqID       _.Requirement                                                                                                                                                                                                                                                 _.References
  PS-USR-Oxford-67   webinos SHALL remove access to any additional authorization credentials when a user logs out                                                                                                                                                                       WOS-UC-TA2-006
  PS-USR-TSI-13      webinos SHALL provide a mechanism for applications to use Identifications which safeguard personal privacy needs on one hand side but allow data sharing for applications on basis of a general profile (e.g. temporary unique ID for a given maximum duration).   
  ------------------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ -------------------

### Sharing and protecting personal and contextual data

  ------------------------ ------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------------------------------------
  _.ReqID             _.Requirement                                                                                                                               _.References
  PS-DEV-Oxford-28         The webinos Runtime SHALL provide access control for context structures with user-defined policies                                               WOS-UC-TA7-008: Create contexts from a pre-defined template
  PS-USR-Oxford-30         webinos shall allow user data to be marked as "personal" in order to specify policies on it.                                                   WOS-UC-TA9-001: Receiving local messages and alerts
  PS-USR-Oxford-54         webinos policies SHALL be able to refer to stored data                                                                                           WOS-UC-TA9-006
  PS-USR-Oxford-55         webinos policies SHALL be able to refer to personal profile information                                                                          WOS-UC-TA9-006
  PS-DEV-Oxford-87         The webinos runtime SHALL be capable of limiting access to user credentials to only a specific user, a specific device and set of applications   WOS-UC-TA9-011
  PS-USR-ambiesense-32     webinos SHALL be able to protect the privacy of each user in line with the EU privacy directives.                                                WOS-US-7.3: Implementing Government-mandated Privacy Controls
  PS-USR-VisionMobile-10   webinos SHALL allow users to express their privacy preferences in a consistent way.                                                              Developer experience analysis
  PS-DEV-VisionMobile-11   webinos applications SHALL be able to query the webinos user privacy preferences                                                                 Developer experience analysis
  PS-DWP-VisionMobile-12   webinos shall use user privacy preferences when granting/denying access to user private information.                                             Developer experience analysis
  PS-DEV-ambiesense-14     Privacy policies change according to applications and external circumstances and SHOULD be context-enabled.                                      Derived from: WOS-US-7.2: Usable Privacy Controls for webinos
  PS-DEV-ambiesense-15     It MUST be possible to define context information as public, shared, or private.                                                                 Derived from: WOS-US-12.1: Multiple Device Gaming
  ------------------------ ------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------------------------------------

### Policy management, authoring and usage features

|_.ReqID |_.Requirement |_.References |
|PS-USR-Oxford-113 | There SHALL be a method for users to view and edit policies at both a fine-grained level and separately for coarse, quick-to-use actions | |
| -PS-USR-Oxford-35- | -webinos access control policies shall be able to specify fine-grained controls involving the source and content of an access control request- | -WOS-UC-TA9-002: Interpreting policies and making access control decisions-|
|PS-USR-Oxford-37 | webinos SHALL allow access control decisions to be logged | WOS-UC-TA9-002: Interpreting policies and making access control decisions |
|PS-USR-Oxford-38 | webinos SHALL allow policies which specify confirmation at runtime by a user when an access request decision is required | WOS-UC-TA9-002: Interpreting policies and making access control decisions |
|PS-USR-Oxford-40 | Users SHALL be able to modify policies about events before they occur (e.g. up-front policy specification) | WOS-UC-TA9-003: Enforcing multiple policies on multiple devices |
|PS-USR-Oxford-49 | User SHALL be able to view & manage application policies | WOS-UC-TA9-006, WOS-UC-Ta6-003: Modification of application policies |
|PS-USR-Oxford-50 | Users SHALL be provided with the ability to identify applications which have been granted particular privileges | WOS-UC-TA9-006 |
|PS-USR-Oxford-52 | Users SHALL be able to modify policies | WOS-UC-TA9-006 |
| -PS-USR-Oxford-53- | -webinos policies SHALL be capable of referring to and specifying restrictions on device capabilities and features, application data, context and personal information held in webinos, and access to other devices and applications.- | -WOS-UC-TA9-006, WOS-UC-TA9-002- |
|PS-DWP-POLITO-003 | Non-necessary information leakage SHOULD be prevented to protect user privacy. | WOS-UC-TA5-001 Discovering the application|
|PS-USR-Oxford-58 | If users are prevented from modifying some policy settings, webinos shall present users with an explanation of why modification is denied. | WOS-UC-TA9-006 |
|PS-USR-Oxford-75 | The webinos runtime SHALL be able to alert the user at runtime | WOS-UC-TA4-014 |
|PS-USR-Oxford-80 | There SHALL be a method for switching the currently-applied user policy. | WOS-UC-TA9-009
WOS-UC-Ta6-004
WOS-UC-Ta6-005,
WOS-UC-Ta(x)–00x: Building and Deploying the webinos Application Package
 WOS-UC-Ta(x)–00x: Debugging Applications on Real Device |
|PS-USR-Oxford-84 | Users SHALL be able to override policy decisions made by a third-party policy management service | WOS-UC-TA9-010 |
|PS-DEV-IBBT-004 | A publish-subscribe system for events SHALL exist which requires authorisation for application subscriptions. webinos SHOULD provide a policy system regarding events. | WOS-UC-TA4-001 |

### Protection and Lifecycle of policies

  -------------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -----------------------------------------------------------------
  _.ReqID               _.Requirement                                                                                                                                                                                                                                                                                                                        _.References
  PS-USR-Oxford-114          Policies are subject to install, update, revocation, deletion. webinos SHALL provide systems and mechanisms for supporting these activities.                                                                                                                                                                                              
  PS-USR-Oxford-42           webinos shall be able to enforce multiple policies in a hierarchy.                                                                                                                                                                                                                                                                        WOS-UC-TA9-003: Enforcing multiple policies on multiple devices
  PS-USR-Oxford-43           A more privileged user (or owner) shall be able to specify a policy which overrides a less-privileged user.                                                                                                                                                                                                                               WOS-UC-TA9-003: Enforcing multiple policies on multiple devices
  -PS-DMA-DEV-Oxford-47-   -It SHALL be possible for the webinos runtime to be installed with default policies-                                                                                                                                                                                                                                                    -WOS-UC-TA9-005-
  PS-USR-Oxford-48           The authenticity and integrity of policies shall be enforced                                                                                                                                                                                                                                                                              WOS-UC-TA9-005
  PS-DEV-Oxford-56           Applications shall be aware of changes to policies and may alter their behaviour as a result                                                                                                                                                                                                                                              WOS-UC-TA9-006
  PS-ALL-Oxford-61           All webinos stakeholders SHALL be able to author policies.                                                                                                                                                                                                                                                                                (From the policy story)
  PS-USR-Oxford-73           The webinos System SHALL support policies which can be remotely updated                                                                                                                                                                                                                                                                   WOS-UC-TA4-013
  PS-DEV-Oxford-79           There SHALL be an online resource which provides examples of common (anonymised) user policies for use by developers                                                                                                                                                                                                                      WOS-UC-TA8-007
  PS-USR-Oxford-81           webinos SHALL support outsourced policy management                                                                                                                                                                                                                                                                                        WOS-UC-TA9-010
  PS-USR-Oxford-82           A webinos application store MAY support the configuration of a "Policy management service" which provides outsourced policy decisions                                                                                                                                                                                                   WOS-UC-TA9-010
  PS-USR-Oxford-83           The webinos runtime SHALL support "linking" a user account to a policy management service and integrate this service into the policy process                                                                                                                                                                                            WOS-UC-TA9-010
  PS-USR-ISMB-036            The webinos Runtime SHALL support the download, install, update and removal of security policies. These operations SHALL require authorisation by the user and policies MUST be checked for authenticity and integrity.                                                                                                                   9.1.5. WOS-UC-TA9-005: Download and install of webinos policies
  PS-DEV-ambiesense-25       The webinos runtime SHALL protect policies from tampering or modification by unauthorised applications. The only authorised applications SHALL be from signed, trusted sources, which may be defined by the manufacturer, network provider or end user. Users SHALL be warned if an application requests permission to modify policies.   WOS-UC-TA8-005 Download and Install of webinos Policies
  -------------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -----------------------------------------------------------------

### Application policies and protection

  ------------------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------------------------------------------------------------------
  _.ReqID                    _.Requirement                                                                                                                                                                                                          _.References
  -PS-USR_DEV-Oxford-44-   -Applications shall specify at install time (or first use) the functionality they require access to.-                                                                                                                     -WOS-UC-TA9-004: Install-time presentation and negotiation of application policies-
  PS-USR_DEV-Oxford-45       Users shall be able to specify at application install time (or first use) which functionality they permit an application to have access to.                                                                                 WOS-UC-TA9-004: Install-time presentation and negotiation of application policies
  PS-USR_DEV-Oxford-46       Applications SHALL request for access rights to any device feature or policy-controlled item prior to accessing it. If an access request is denied, applications shall be notified to deal with this gracefully             WOS-UC-TA9-004: Install-time presentation and negotiation of application policies, WOS-US-7.1 Designing Policy-aware webinos Applications
  PS-USR-Oxford-57                webinos shall deny users the ability to modify some policy settings if a policy by a more privileged authority exists which overrides them.                                                                                 WOS-UC-TA9-006
  PS-DEV-Oxford-64                The webinos Runtime SHALL use the most secure communication option available unless otherwise specified by an application or user.                                                                                          WOS-UC-TA4-015 involves sending a medical file with assumed private information
  PS-USR-Oxford-69                Users SHALL be informed of any intended access to critical APIs used by a webinos application at install time.                                                                                                              WOS-UC-TA3-001
  PS-USR-Oxford-72                The webinos System SHALL support applications which apply access control policies to data produced or owned by the application developer. These policies MAY support revocation of access control permissions               WOS-UC-TA4-013
  PS-DEV-Oxford-88                A method MUST be provided to enable webinos applications to explain why access to data or APIs is being requested                                                                                                           WOS-UC-TA9-013, WOS-US-7.1 Designing Policy-aware webinos Applications
  PS-DEV-Oxford-89                A method MUST be provided to enable webinos applications to explain how collected sensitive data will be managed (e.g., company name, purpose description).                                                                 PS-DEV-Oxford-88, WOS-UC-TA5-001, WOS-UC-TA5-002, WOS-UC-TA5-003, WOS-UC-TA5-004
  -PS-USR-Oxford-102-           -Installation SHALL be granted or denied according to security policies-                                                                                                                                                  -WOS-UC-Ta6-007: Installing an application-
  PS-USR-Oxford-123               The webinos runtime MUST enforce any application restrictions specifying whether an application may run on the device                                                                                                       
  PS-DEV-ambiesense-21            An application developer MUST be able to define and control a privacy policy for his or her application that is separate from all other applications. Any changes to an existing policy MUST be approved by the end user.   WOS-US-7.1 Designing Policy-aware webinos Applications
  ------------------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------------------------------------------------------------------

### Runtime protection

  ----------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------
  _.ReqID            _.Requirement                                                                                                                                                                                    _.References
  -PS-USR-Oxford-116-   -The webinos Runtime Environment SHALL protect applications and itself from potentially malicious applications and SHALL protect the device from being made unusable or damaged by applications.-   
  PS-USR-Oxford-34        webinos shall provide complete mediation of access requests by applications and enforce all policies                                                                                                  WOS-UC-TA9-002: Interpreting policies and making access control decisions
  PS-USR-Oxford-59        The webinos runtime environment SHALL securely store application data to prevent disclosure to unauthorised entities                                                                                  WOS-UC-TA9-012
  PS-USR-TSI-3            webinos shall ensure that no application can use more resources (e.g., CPU, memory, …) than declared ahead                                                                                            
  PS-DWP-ISMB-202         The webinos runtime MUST ensure that an application does not access device features, extensions and content other than those associated to it.                                                        WOS-UC-TA6-00X: Checking access to APIs
  ----------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------

### webinos component authorization

  ------------------- ----------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------
  _.ReqID        _.Requirement                                                                                                            _.References
  PS-USR-Oxford-120   A webinos Cloud shall determine the services a webinos Device is authorised to use before providing access to its services.   WOS-UC-TA5-001: Discovering the application
  ------------------- ----------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------

Negotiation and Compatibility
-----------------------------

### Policy Negotiation

  ------------------ -------------------------------------------------------------------------------------------------- ---------------------- -- ---------------------- ------------------------------------------------------------------------------------------------------------------- --------------------------
  _.ReqID       _.Requirement                                                                                 _.References
  NC-DEV-IBBT-009    An application MUST be able to define preferences regarding the resources it needs to access.      4.1.1 WOS-UC-TA4-001
  NC-DWP-IBBT-0010   The webinos platform MUST be able to check differences in application policies between versions.   5.1.5 WOS-UC-TA5-005
  ------------------ -------------------------------------------------------------------------------------------------- ---------------------- -- ---------------------- ------------------------------------------------------------------------------------------------------------------- --------------------------

Lifecycle
---------

### Application Metadata

|_.ReqID |_.Requirement |_.References |
|LC-DEV-ISMB-003 | An application MUST be associated with required and optional APIs it MAY use, as well as their minimum/supported versions. | 3.1.4. WOS-UC-TA3-004: Embedding Proprietary Extensions
5.1.1. WOS-UC-TA5-001: Discovering the application
5.1.2. WOS-UC-TA5-002: Executing the application from the web or another device (no installation)
5.1.3. WOS-UC-TA5-003: Executing the application from the web or another device (partial installation)
5.1.4. WOS-UC-TA5-004: Installation and update of webinos applications
9.1.4. WOS-UC-TA9-004: Install-time presentation and negotiation of application policies
9.1.11. WOS-UC-TA9-011: Developing an application which requires access to policy-controlled device functions |
|LC-DEV-ISMB-006 | An application MUST be associated with a method (e.g. digital signature) for the webinos runtime to perform origin authenticity and integrity checking. | 5.1.2. WOS-UC-TA5-002: Executing the application from the web or another device (no installation)
5.1.3. WOS-UC-TA5-003: Executing the application from the web or another device (partial installation)
5.1.4. WOS-UC-TA5-004: Installation and update of webinos applications |

### -Application lifecycle-

|_.ReqID |_.Requirement |_.References |
|-LC-USR-ISMB-037- | -The user SHALL be able to transfer, install, update or remove Installable Applications from/to the devices he/she owns at any time, also remotely.- | -1.1.6. WOS-UC-Ta1-006: Pairing a new device to clone settings
1.1.8. WOS-UC-TA1-008: webinos Federation
3.1.1. WOS-UC-TA3-001: Application Push
3.1.3. WOS-UC-TA3-003: Application Advertisement
5.1.1. WOS-UC-TA5-001: Discovering the application
5.1.3. WOS-UC-TA5-003: Executing the application from the web or another device (partial installation)
5.1.4. WOS-UC-TA5-004: Installation and update of webinos applications
5.1.7. WOS-UC-TA5-007: Update of applications
8.1.1. WOS-UC-TA8-001: Pairing a new device to configure webinos- |
|-LC-USR-ISMB-038- | -The user SHALL be able to transfer, install, update or remove Installable Applications from/to the devices he/she owns from within other applications.- | -3.1.1. WOS-UC-TA3-001: Application Push- |
|-LC-USR-ISMB-039- | -It SHALL be possible for an authorized entity that is not the user to transfer, install, update or remove Installable Applications from/to one or more devices owned by the user. Such authorized entity SHALL provide a motivation to the user.- | -5.1.8. WOS-UC-TA5-008: Removal of applications- |

Device and Service Functional Capability
----------------------------------------

### Access to HW and SW resources

|_.ReqID |_.Requirement |_.References |
|CAP-DWB-FHG-002 | The webinos runtime SHOULD allow access to non-webinos APIs to device features | WOS-UC-TA3-004: Embedding Proprietary Extensions |
|CAP-DEV-SEMC-001 | A webinos user agent MUST support access control for webinos applications access to the user’s HW and SW resources that need access protection. | WOS-UC-TA1-001: Virtual Device
WOS-UC-TA1-002: Network Independent Virtual Device
WOS-UC-Ta1-003: Virtual Device Ownership
WOS-UC-TA1-005: Sensors and Actuators
Etc. |

### Access to remote devices and applications

|_.ReqID |_.Requirement |_.References |
|CAP-DEV-FHG-100 | Access to resources on remote devices SHALL be available | WOS-UC-TA1-002: Network Independent Virtual Device
WOS-UC-TA1-003: Virtual Device Ownership
WOS-UC-TA1-005: Sensors and Actuators
WOS-UC-TA3-002: Code Outsourcing |

### Application execution

  ----------------- ----------------------------------------------------------------------------------------------------------- --------------------------------------------------------
  _.ReqID      _.Requirement                                                                                          _.References
  CAP-DEV-FHG-204   It SHALL be possible to ‘park’ a session state in the cloud and continue the session from another device.   WOS-UC-TA4-016: Handover VoD Context from PC to Mobile
  ----------------- ----------------------------------------------------------------------------------------------------------- --------------------------------------------------------

Transfer and Management of State
--------------------------------

### State definition and access

|_.ReqID |_.Requirement |_.References |
|TMS-DWP-POLITO-002 | Attributes values that describe application state SHALL be available to authorized entities (e.g. applications) only | 5.1.1. WOS-UC-TA5-001: Discovering the application
5.1.2. WOS-UC-TA5-002: Executing the application from the web or another device (no installation)
5.1.3. WOS-UC-TA5-003: Executing the application from the web or another device (partial installation)
5.1.4. WOS-UC-TA5-004: Installation and update of webinos applications - Policy and Security, APIs, WRE |
|TMS-DWP-POLITO-004 | The webinos runtime MAY protect confidentiality of state data when transferred from one authorized device to another | 5.1.1. WOS-UC-TA5-001: Discovering the application
5.1.2. WOS-UC-TA5-002: Executing the application from the web or another device (no installation)
5.1.3. WOS-UC-TA5-003: Executing the application from the web or another device (partial installation)
5.1.4. WOS-UC-TA5-004: Installation and update of webinos applications
WOS-UC-TA4-006: Sharing Application States across Several Devices
Policy and Security, WRT, webinos Agent |
|TMS-DWP-POLITO-005 | The webinos runtime SHALL protect integrity of state data when transferred from one authorized device to another | 5.1.1. WOS-UC-TA5-001: Discovering the application
5.1.2. WOS-UC-TA5-002: Executing the application from the web or another device (no installation)
5.1.3. WOS-UC-TA5-003: Executing the application from the web or another device (partial installation)
5.1.4. WOS-UC-TA5-004: Installation and update of webinos applications
Policy and Security, WRT, webinos Agent |
|TMS-DWP-POLITO-006 | The webinos runtime SHALL ensure originator’s authenticity of state attributes when exchanged from one authorized device to another | 5.1.1. WOS-UC-TA5-001: Discovering the application
5.1.2. WOS-UC-TA5-002: Executing the application from the web or another device (no installation)
5.1.3. WOS-UC-TA5-003: Executing the application from the web or another device (partial installation)
5.1.4. WOS-UC-TA5-004: Installation and update of webinos applications - Policy and Security, WRT, webinos Agent |

### Transferring Application State Between Devices Belonging to the Same User

  ---------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------
  _.ReqID           _.Requirement                                                                                                                                      _.References
  TMS-DEV-VOLANTIS-004   A webinos application SHOULD be able to synchronize its data with an application working on another authorized device at specific time periods.         WOS-UC-TA1-014
  TMS-DEV-VOLANTIS-005   A webinos application SHOULD be able to synchronize its data with an application working on another authorized device when launching the application.   WOS-UC-TA1-014
  TMS-DEV-VOLANTIS-006   A webinos application SHOULD be able to synchronize its data with an application working on another authorized device when exiting the application.     WOS-UC-TA1-014
  TMS-DEV-VOLANTIS-007   A webinos application MUST be able to synchronize just a subset of data with an application working on another authorized device.                       WOS-UC-TA4-005
  TMS-USR-POLITO-008     A webinos application SHOULD allow user to define which attribute to synchronize with an application working on another authorized device.              4.1.5 WOS-UC-TA4-005: Progressive Download and Store Content in a Secure File Storage
  ---------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------

### Methods of Transferring the Application State

  ---------------------- ------------------------------------------------------------------------------------------------------------------- -------------------
  _.ReqID           _.Requirement                                                                                                  _.References
  TMS-DWP-VOLANTIS-013   The webinos platform MAY be able to select the most appropriate way method of synchronizing the application data.   WOS-UC-TA4-002
  ---------------------- ------------------------------------------------------------------------------------------------------------------- -------------------

### Managing the Application State

  ---------------------- ------------------------------------------------------------------------------------------------------------------------------------- -------------------
  _.ReqID           _.Requirement                                                                                                                    _.References
  TMS-USR-VOLANTIS-015   The webinos user SHOULD be able to disable synchronization for selected applications.                                                 
  TMS-USR-VOLANTIS-016   The webinos user SHOULD be able to disable synchronization for selected devices.                                                      
  TMS-USR-VOLANTIS-017   The webinos user SHOULD be able to list and to manage all the applications which synchronize their data with other webinos devices.   
  ---------------------- ------------------------------------------------------------------------------------------------------------------------------------- -------------------

### Online Collaboration

  ------------------ ----------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------
  _.ReqID       _.Requirement                                                                                                                              _.References
  TMS-DEV-SEMC-018   The webinos system SHALL support the possibility to share and edit data objects for online collaborative applications in a responsive manner.   WOS-UC-TA4-006: Sharing Application States across Several Devices
  TMS-DEV-SEMC-019   The webinos system MUST be able to resolve inconsistencies if two or more parties are modifying the same data object.                           WOS-UC-TA4-006: Sharing Application States across Several Devices
  ------------------ ----------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------

### Various other requirements

  ------------------- ----------------------------------------------------------------------------------------------- ---------------------------------
  _.ReqID        _.Requirement                                                                              _.References
  TMS-USR-Oxford-29   For each identified device on a webinos cloud, the current device status shall be registered.   WOS-UC-TA4-017: Wake-on-webinos
  ------------------- ----------------------------------------------------------------------------------------------- ---------------------------------

Protocol definitions
--------------------

Define any protocols that must exist between elements - and data structures. May be done be reference to pre-existing specs - or create new ones.

This is likely to concentrate on how policies are synchronised and on how permissions are granted in certain situations.

Javascript APIs
---------------

WebIDL definitions of 3rd party accessible functionality. This is likely to cover just how policy requests are handled (errors, etc) and how the permissions database can be queried.

<pre><code class="javascript">

function hasPermission(permission-id)
{
 //…
}

</code></pre>
h2. Dependencies on other components

identify interface points to other components:

e.g.Policy -> ID

Implementation Architecture
---------------------------

Start to look at actual **implementation** issues for code - this does not presume interoperability and will consider platform specific issues

